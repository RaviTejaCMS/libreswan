# note swan-prep does not yet supprt iked
# note swan-prep does not yet supprtoes not yet supprt iked
openbsdw #
 #/testing/guestbin/swan-prep
#/testing/guestbin/swan-prep
openbsdw #
 cp openbsdw.conf /etc/iked.conf
cp openbsdw.conf /etc/iked.conf
openbsdw #
 chmod 600 /etc/iked.conf
chmod 600 /etc/iked.conf
openbsdw #
 /sbin/iked
/sbin/iked
openbsdw #
 echo "initdone"
echo "initdone"
initdone
openbsdw #
 # check output on openbsd end
# check output on openbsd end
openbsdw #
 test -f /sbin/ipsecctl && ipsecctl -s all | sort
test -f /sbin/ipsecctl && ipsecctl -cctl && ipsecctl -s all | sort
FLOWS:
SAD:
esp tunnel from 192.1.2.23 to 192.1.2.45 spi 0xSPISPI auth hmac-sha2-256 enc aes-256
esp tunnel from 192.1.2.45 to 192.1.2.23 spi 0xSPISPI auth hmac-sha2-256 enc aes-256
flow esp in from 192.0.2.0/24 to 192.0.1.0/24 peer 192.1.2.23 srcid FQDN/west dstid FQDN/east type require
flow esp out from 192.0.1.0/24 to 192.0.2.0/24 peer 192.1.2.23 srcid FQDN/west dstid FQDN/east type require
openbsdw #
 ../bin/check-for-core.sh
../bin/check-for-core.sh
openbsdw #
 if [ -f /sbin/ausearch ]; then ausearch -r -m avc -ts recent ; fi
if [ -f /sbin/ausearch ]; then auseaarch ]; then ausearch -r -m avc -ts recent ; fi

